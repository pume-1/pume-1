# Pume: Purification Framework for Machine Learning-based Effective Vulnerability Detection
The framework of Pume consists 
of two main phases: Detection Preparation and Vulnerability Detection.
The input of Pume is the source code of the target function, and the 
output is the vulnerability detection results and the vulnerability type.<br><br>
In detail, the preparation phase of Pume consists of data preprocessing and slice purification.
The input to this module is a portion of samples from the dataset containing both vulnerable and non-vulnerable functions. 
The outputs are trained anomaly detector and KMeans model, 
which are used to generate features of the functions in the detection module.<br>
It is important to note that the data used in the preparation module is not reused 
in the vulnerability detection module.The detection phase of Pume includes feature extraction and classification. For the target function, Pume performs vulnerability detection with its feature 
vectors generated by the anomaly detector and KMeans model.<br><br>

• Data Preprocessing: For the source code of the target function, 
we first perform program slicing to generate its slices and 
then embed them into the slice vector.<br>
• Slice Purification: We implement a two-step purification method 
for the slices of a function, including hash filtering and anomaly 
detection filtering, to filter out the vulnerability-unrelated 
behaviors and extract the vulnerability pattern.<br>
• Feature Extraction: For the target function, we first extract 
the feature of its slices and then use them to construct the 
features of the function.<br>
• Classification: For the feature of the function, we feed 
it into a machine learning-based model for detection and infer 
its vulnerability type as the fine-grained detection results.<br><br>
PS. The datasets are in the master branch.

